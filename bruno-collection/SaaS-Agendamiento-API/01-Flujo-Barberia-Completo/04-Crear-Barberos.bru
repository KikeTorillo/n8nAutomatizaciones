meta {
  name: 04 - Crear Barberos
  type: http
  seq: 4
}

post {
  url: {{baseUrl}}/api/v1/profesionales
  body: json
  auth: bearer
}

auth:bearer {
  token: {{managerBarberiaToken}}
}

headers {
  Content-Type: application/json
}

body:json {
  {
    "nombre": "Juan Carlos",
    "apellidos": "P√©rez L√≥pez",
    "email": "juan.barbero@barbariaelclasico.com",
    "telefono": "+573101234567",
    "tipo_profesional": "barbero",
    "especialidades": ["corte_clasico", "barba", "bigote", "afeitado_navaja"],
    "horarios_disponibles": {
      "lunes": {"inicio": "09:00", "fin": "18:00"},
      "martes": {"inicio": "09:00", "fin": "18:00"},
      "miercoles": {"inicio": "09:00", "fin": "18:00"},
      "jueves": {"inicio": "09:00", "fin": "18:00"},
      "viernes": {"inicio": "09:00", "fin": "19:00"},
      "sabado": {"inicio": "08:00", "fin": "16:00"}
    },
    "informacion_adicional": {
      "experiencia_anos": 12,
      "certificaciones": ["Barber√≠a Cl√°sica", "T√©cnicas de Afeitado"],
      "fecha_ingreso": "2023-03-15",
      "biografia": "Barbero especializado en t√©cnicas cl√°sicas con m√°s de 12 a√±os de experiencia."
    }
  }
}

tests {
  test("Status should be 201", function() {
    expect(res.getStatus()).to.equal(201);
  });

  test("Response should contain success true", function() {
    const body = res.getBody();
    expect(body).to.have.property('success', true);
  });

  test("Should create barbero professional", function() {
    const body = res.getBody();
    expect(body.data).to.have.property('tipo_profesional', 'barbero');
    expect(body.data).to.have.property('nombre', 'Juan Carlos');
  });

  test("Should belong to barber√≠a organization", function() {
    const body = res.getBody();
    expect(body.data.organizacion_id).to.equal(bru.getVar("barbariaOrgId"));
  });

  test("Should validate barbero compatible with barber√≠a", function() {
    const body = res.getBody();
    // barbero es compatible con industria barberia
    expect(body.data.tipo_profesional).to.equal('barbero');
  });

  test("Should set barbero variables", function() {
    const body = res.getBody();
    if (body.success && body.data.id) {
      bru.setVar("barberoId", body.data.id);
      bru.setVar("barberoEmail", body.data.email);
    }
  });

  test("Barbero ready for service", function() {
    const body = res.getBody();
    console.log("‚úÇÔ∏è Barbero creado exitosamente");
    console.log(`üë§ Nombre: ${body.data.nombre} ${body.data.apellidos}`);
    console.log(`üìß Email: ${body.data.email}`);
    console.log(`üì± Tel√©fono: ${body.data.telefono}`);
    console.log(`üéØ Especialidades: ${body.data.especialidades.join(', ')}`);
    console.log(`üìÖ Horarios: Lun-Vie 09:00-18:00, S√°b 08:00-16:00`);
    console.log(`‚≠ê Experiencia: ${body.data.informacion_adicional.experiencia_anos} a√±os`);
    console.log(`üÜî ID Profesional: ${body.data.id}`);
  });
}