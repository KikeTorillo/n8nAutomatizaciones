{
  "name": "comisiones",
  "display_name": "Sistema de Comisiones",
  "version": "1.1.0",
  "description": "Cálculo automático de comisiones por citas completadas y ventas POS con configuración flexible por servicio y producto",
  "depends": ["core"],
  "dependencies_hard": {},
  "dependencies_optional": {
    "agendamiento": {
      "razon": "Permite calcular comisiones de citas completadas (trigger automático)",
      "tablas": ["citas", "profesionales", "clientes", "servicios"],
      "trigger": "calcular_comision_cita() se dispara al completar cita",
      "campo_origen": "origen = 'cita'"
    },
    "pos": {
      "razon": "Permite calcular comisiones de ventas POS (trigger automático)",
      "tablas": ["ventas_pos", "detalles_venta_pos", "productos"],
      "trigger": "calcular_comision_venta() se dispara al completar venta",
      "campo_origen": "origen = 'venta'"
    }
  },
  "pricing": {
    "base_mensual": 99,
    "currency": "MXN",
    "incluido_en": ["profesional", "empresarial"],
    "addon_para": ["basico"],
    "notes": "Ideal para negocios con múltiples profesionales"
  },
  "routes": {
    "comisiones": "/api/v1/comisiones",
    "configuracion": "/api/v1/comisiones/configuracion",
    "dashboard": "/api/v1/comisiones/dashboard"
  },
  "resources": {
    "comisiones_profesionales": {
      "table": "comisiones_profesionales",
      "limit_field": null,
      "notes": "Sin límite, generadas automáticamente"
    },
    "configuracion_comisiones": {
      "table": "configuracion_comisiones",
      "limit_field": null,
      "notes": "Configuración por servicio"
    }
  },
  "tables": [
    "configuracion_comisiones",
    "comisiones_profesionales",
    "historial_comisiones"
  ],
  "features": [
    "Cálculo automático por cita completada (módulo agendamiento)",
    "Cálculo automático por venta POS (módulo pos)",
    "Configuración por servicio (porcentaje, monto fijo, mixto)",
    "Configuración por producto (porcentaje, monto fijo, mixto)",
    "Campo 'aplica_a': servicio, producto o ambos",
    "Dashboard de comisiones por profesional",
    "Historial completo con auditoría",
    "Exportación CSV/JSON",
    "Estadísticas y gráficas por período",
    "Detalle JSONB con breakdown por servicio/producto",
    "RLS: Admin ve todo, empleado solo sus comisiones"
  ],
  "priority": 20,
  "required": false,
  "can_disable": true
}
