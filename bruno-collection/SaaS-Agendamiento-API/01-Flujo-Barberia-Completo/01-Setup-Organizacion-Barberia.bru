meta {
  name: 01 - Setup Organizaci√≥n Barber√≠a
  type: http
  seq: 1
}

post {
  url: {{baseUrl}}/api/v1/organizaciones
  body: json
  auth: bearer
}

auth:bearer {
  token: {{adminToken}}
}

headers {
  Content-Type: application/json
}

body:json {
  {
    "nombre": "Barber√≠a El Cl√°sico",
    "email": "contacto@barbariaelclasico.com",
    "telefono": "+573001234567",
    "direccion": "Calle 85 #15-23, Chapinero, Bogot√°",
    "tipo_industria": "barberia",
    "plan": "profesional",
    "configuracion": {
      "horario_apertura": "08:00",
      "horario_cierre": "20:00",
      "dias_laborales": ["lunes", "martes", "miercoles", "jueves", "viernes", "sabado"],
      "duracion_cita_default": 45,
      "permite_reservas_online": true,
      "tiempo_anticipacion_min": 60,
      "tiempo_cancelacion_max": 120
    }
  }
}

tests {
  test("Status should be 201", function() {
    expect(res.getStatus()).to.equal(201);
  });

  test("Response should contain success true", function() {
    const body = res.getBody();
    expect(body).to.have.property('success', true);
  });

  test("Should create barber√≠a organization", function() {
    const body = res.getBody();
    expect(body.data).to.have.property('tipo_industria', 'barberia');
    expect(body.data).to.have.property('nombre', 'Barber√≠a El Cl√°sico');
  });

  test("Should set barber√≠a variables", function() {
    const body = res.getBody();
    if (body.success && body.data.id) {
      bru.setVar("barbariaOrgId", body.data.id);
      bru.setVar("barbariaEmail", body.data.email);
      bru.setVar("barbariaTelefono", body.data.telefono);
    }
  });

  test("Configuration should be properly set", function() {
    const body = res.getBody();
    expect(body.data.configuracion).to.have.property('horario_apertura', '08:00');
    expect(body.data.configuracion).to.have.property('horario_cierre', '20:00');
    expect(body.data.configuracion.dias_laborales).to.include('sabado');
  });

  test("Barber√≠a ready for operations", function() {
    const body = res.getBody();
    console.log("üè™ Barber√≠a El Cl√°sico creada exitosamente");
    console.log(`üìß Email: ${body.data.email}`);
    console.log(`üì± Tel√©fono: ${body.data.telefono}`);
    console.log(`üè¢ Direcci√≥n: ${body.data.direccion}`);
    console.log(`‚è∞ Horario: ${body.data.configuracion.horario_apertura} - ${body.data.configuracion.horario_cierre}`);
    console.log(`üìã Plan: ${body.data.plan}`);
    console.log(`üÜî ID Organizaci√≥n: ${body.data.id}`);
  });
}