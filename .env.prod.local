# =========================================
# VARIABLES DE ENTORNO - PRODUCCIÓN
# n8nflowautomat.com con SUBDOMINIOS
# =========================================
# Arquitectura:
#   - n8nflowautomat.com       → Frontend
#   - api.n8nflowautomat.com   → Backend API
#   - n8n.n8nflowautomat.com   → n8n UI
# =========================================

# ========================================
# CONFIGURACIÓN JWT PARA AUTENTICACIÓN
# ========================================
JWT_SECRET=tuSuperSecretoJWTParaTokensDeAcceso2025SaaSAgendamiento
JWT_EXPIRES_IN=7d
JWT_REFRESH_SECRET=tuSuperSecretoJWTParaTokensDeRefresco2025SaaSAgendamiento
JWT_REFRESH_EXPIRES_IN=30d

# ========================================
# CONFIGURACIÓN DE BASE DE DATOS POSTGRESQL
# ========================================
POSTGRES_DB=postgres
POSTGRES_USER=admin
POSTGRES_PASSWORD=MYCCP6ot1ZcULVQDV4uX6CH9tOjQVPVo

# ========================================
# CONFIGURACIÓN DE N8N
# ========================================
# IMPORTANTE: No cambiar N8N_ENCRYPTION_KEY o se perderán datos cifrados
N8N_ENCRYPTION_KEY=9ig6RTvjLmfWSVevOZsJdkfw4WbuqkRC
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=0SkyhE24GPA1z1Hdd7Tv3nZSObgR3vCr

# ========================================
# CONFIGURACIÓN DE PGADMIN
# ========================================
PGADMIN_DEFAULT_EMAIL=admin@admin.com
PGADMIN_DEFAULT_PASSWORD=giN3eMXRoSYFHXyw1CmMn6jRAPs5LKzP

# ========================================
# CONFIGURACIÓN DE WEBHOOKS Y URLs - LOCAL SIMULATION
# ========================================
# ⚠️ SIMULACIÓN LOCAL: Usar localhost en lugar de dominio
WEBHOOK_URL=https://foam-leaving-salary-zoning.trycloudflare.com

# ⚠️ SIMULACIÓN LOCAL: Editor de n8n en localhost
N8N_EDITOR_BASE_URL=https://foam-leaving-salary-zoning.trycloudflare.com 

# NO necesitamos N8N_PATH con subdominios
# N8N_PATH queda vacío o se omite

# ========================================
# CONFIGURACIÓN REGIONAL Y DE SISTEMA
# ========================================
TZ=America/Mexico_City

# ========================================
# CONTRASEÑAS DE USUARIOS DE BASE DE DATOS
# ========================================
SAAS_APP_PASSWORD=saas_secure_K7mN9pQ2vX8sL4wE
N8N_APP_PASSWORD=n8n_secure_R5jB7nM3kF9hP6zY
READONLY_USER_PASSWORD=readonly_secure_D8qM5wK7pL3vN9xZ
INTEGRATION_USER_PASSWORD=integration_secure_J6fR9sL2nP5kM8wQ

# ========================================
# CONFIGURACIÓN BACKEND SAAS - BASE DE DATOS
# ========================================

# === BASE DE DATOS PRINCIPAL SAAS ===
DB_HOST=postgres
DB_PORT=5432
DB_NAME=postgres
DB_USER=saas_app
DB_PASSWORD=saas_secure_K7mN9pQ2vX8sL4wE

# === BASE DE DATOS N8N ===
N8N_DB_HOST=postgres
N8N_DB_PORT=5432
N8N_DB_NAME=n8n_db
N8N_DB_USER=n8n_app
N8N_DB_PASSWORD=n8n_secure_R5jB7nM3kF9hP6zY

# === BASE DE DATOS CHAT MEMORIES ===
CHAT_DB_HOST=postgres
CHAT_DB_PORT=5432
CHAT_DB_NAME=chat_memories_db
CHAT_DB_USER=n8n_app
CHAT_DB_PASSWORD=n8n_secure_R5jB7nM3kF9hP6zY

# ========================================
# CONFIGURACIÓN DE APLICACIÓN
# ========================================
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# === CORS CONFIGURATION (localhost frontend) ===
CORS_ORIGIN=http://localhost:8080

# === RATE LIMITING (más estricto en producción) ===
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# === REDIS CONFIGURATION ===
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=

# ========================================
# CONFIGURACIÓN DE N8N OWNER (SETUP AUTOMÁTICO)
# ========================================
N8N_OWNER_EMAIL=admin@saas-agendamiento.local
N8N_OWNER_FIRST_NAME=Admin
N8N_OWNER_LAST_NAME=Sistema

# API Key de n8n (generado en n8n UI: Settings → API)
N8N_API_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkNTkyYmRmNy1lMmFhLTQwZGItYWFmNy0zYjAxMDAzYTFlOWQiLCJpc3MiOiJuOG4iLCJhdWQiOiJwdWJsaWMtYXBpIiwiaWF0IjoxNzYxNjIwOTI5fQ.-ZuE1UUJyQ0n1jTJDpPH0xgBKv37spiYiul5l7wboks

# URL interna de n8n para el backend (comunicación entre contenedores en producción)
N8N_API_URL=http://n8n-main-prod:5678

# ========================================
# EXTERNAL APIs
# ========================================
DEEPSEEKAPIKEY=sk-707bca194d404ea28d80f9a3f8e99a80

# === SKIP VALIDACIONES EXTERNAS (PRODUCCIÓN) ===
# En producción SIEMPRE debe ser false para validar tokens reales
SKIP_TELEGRAM_VALIDATION=false

# ========================================
# DOCKER VERSION (para tags de imágenes)
# ========================================
VERSION=latest

# =========================================
# NOTAS IMPORTANTES PARA PRODUCCIÓN
# =========================================
# 1. WEBHOOK_URL apunta al dominio principal:
#    https://n8nflowautomat.com
#    Los webhooks van a: https://n8nflowautomat.com/webhook/abc123
#
# 2. N8N_EDITOR_BASE_URL apunta al subdominio de n8n:
#    https://n8n.n8nflowautomat.com
#
# 3. Backend API estará en:
#    https://api.n8nflowautomat.com
#
# 4. Frontend estará en:
#    https://n8nflowautomat.com
#
# 5. CORS_ORIGIN debe coincidir con el frontend:
#    https://n8nflowautomat.com
#
# 6. Los contenedores en producción tienen nombres diferentes:
#    - n8n-main-prod (en lugar de n8n-main)
#    - back_prod (en lugar de back)
#    - front_prod (en lugar de front)
#    - postgres_db_prod (en lugar de postgres_db)
